{% extends "base.html" %}
{% block title %}Trait Data and Analysis{% endblock %}
{% block content %} <!-- Start of body -->

    <header class="jumbotron subhead" id="overview">
        <div class="container">
            <h1>{{ this_trait.symbol}}</h1>
            <p class="lead">
                {{ this_trait.name }}: {{ this_trait.description_fmt }}
            </p>
        </div>
    </header>



    <div class="container">
        <div class="page-header">
            <h1>{{ this_trait.species.capitalize() }} -
                {{ fd.RISet }} -
                {{ this_trait.symbol }}

            </h1>
        </div>

        <dl class="dl-horizontal">
            <dt>Aliases</dt>
            <dd>{{ this_trait.alias_fmt }}</dd>

            <dt>Location</dt>
            <dd>{{ this_trait.location_fmt }}</dd>

            <dt>Database</dt>
            <dd>
                <a href="{{ this_trait.database.url }}" target="_blank">
                    {{ this_trait.database.name }}
                </a>
            </dd>

            <dt>
                <a href="/blatInfo.html" target="_blank"
                   title="Values higher than 2 for the specificity are good">
                    BLAT Specifity
                </a>
            </dt>
            <dd>{{ "%.1f" % (this_trait.probe_set_specificity) }}</dd>

            <dt>BLAT Score</dt>
            <dd>{{ "%i" % (this_trait.probe_set_blat_score) }}</dd>
        </dl>

        <form method="post" action="/corr_compute" name="dataInput" id="trait_data_form">
        {% for key in hddn %}
            <input type="hidden" name="{{ key }}" value="{{ hddn[key] }}">
        {% endfor %}

        <div class="btn-toolbar">
            <div class="btn-group">
                <button class="btn btn-primary" title="Add to collection">
                    <i class="icon-plus-sign icon-white"></i> Add
                </button>

                <button class="btn" title="Find similar expression data">
                    <i class="icon-search"></i> Find
                </button>

                <button class="btn" title="Check probe locations at UCSC">
                    <i class="icon-ok"></i> Verify
                </button>
            </div>

            <div class="btn-group">

                <button class="btn" title="Write or review comments about this gene">
                    <i class="icon-edit"></i> GeneWiki
                </button>

                <button class="btn" title="View SNPs and Indels">
                    <i class="icon-road"></i> SNPs
                </button>

                <button class="btn" title="View probes, SNPs, and RNA-seq at UTHSC">
                    <i class="icon-eye-close"></i> RNA-seq
                </button>

                <button class="btn" title="Check sequence of probes">
                    <i class="icon-list"></i> Probes
                </button>

            </div>

        </div>



                    <p class="sectionheader" id="title2" style="border-radius: 5px;">&nbsp;&nbsp;Basic Statistics</p>


                    <p id="sectionbody2"></p>Include:
                                            <select name="corr_samples_group" size="1">
                                            {% for group, pretty_group in sample_group_types.items() %}
                                                <option value="{{ group }}">
                                                    {{ pretty_group }}
                                                </option>
                                            {% endfor %}
                                            </select><br>
                    <br>
                    <input type="button" name="Default_Name" class="btn update" value=" Update Figures "><br>
                    <br>

                    <table cellpadding="0" cellspacing="0" border="0" class="display" id="stats_dyn"></table>

                    <table class="target2" cellpadding="0" cellspacing="0" width="100%">
                      <tr>
                        <td>
                          {% for sd in stats_data %}
                          <div class="ui-tabs" id="{{ 'stats_tabs%i' % loop.index0 }}">
                            <ul>
                              <li><a href="#statstabs-1" class="stats_tab">Basic Table</a></li>

                              <li><a href="#statstabs-5" class="stats_tab">Probability Plot</a></li>

                              <li><a href="#statstabs-3" class="stats_tab">Bar Graph (by name)</a></li>

                              <li><a href="#statstabs-4" class="stats_tab">Bar Graph (by rank)</a></li>

                              <li><a href="#statstabs-2" class="stats_tab">Box Plot</a></li>
                            </ul>

                            <div id="statstabs-1">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td>
                                    <table cellpadding="20" cellspacing="0">
                                      <tr>
                                        <td class="fs14 fwb ffl b1 cw cbrb" align="left" width="180">Statistic</td>

                                        <td class="fs14 fwb ffl b1 cw cbrb" align="right" width="60">Value</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" align="left">N of Samples</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes" id="n_of_samples_value">{{ sd.N }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Mean</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes" id="mean_value">{{ "%2.3f" % sd.traitmean }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Median</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes" id="median_value">{{ "%2.3f" % sd.traitmedian }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Standard Error (SE)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.traitsem }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Standard Deviation (SD)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.traitstdev }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Minimum</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.min }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Maximum</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.max }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Range (log2)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.range_log2 }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left"><span>Range (fold)</span></td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.range_fold }}</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left"><span><a href="/glossary.html#Interquartile" target="_blank" class=
                                        "non_bold">Interquartile Range</a></span></td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">{{ "%2.3f" % sd.interquartile }} </td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-5">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/nP_OE9u7BSx.gif" alt="nP_OE9u7BSx.gif" border="0"></td>
                                </tr>

                                <tr>
                                  <td><br>
                                  <br>
                                  This plot evaluates whether data are normally distributed. Different symbols represent different groups.<br>
                                  <br>
                                  More about <a href="http://en.wikipedia.org/wiki/Normal_probability_plot" target="_blank">Normal Probability Plots</a> and more
                                  about interpreting these plots from the <a href="/glossary.html#normal_probability" target="_blank">glossary</a></td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-2">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td align="left">
                                    <img src="/image/Box_gUFtEOVI.gif" alt="Box_gUFtEOVI.gif" border="0">

                                    <p><span>More about <a href="http://davidmlane.com/hyperstat/A37797.html" target="_blank" class="fs13">Box Plots</a></span></p>
                                  </td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-3">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/Bar_y7L2rYlL.gif" alt="Bar_y7L2rYlL.gif" border="0"></td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-4">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/Bar_1Z4GjYFq.gif" alt="Bar_1Z4GjYFq.gif" border="0"></td>
                                </tr>
                              </table>
                            </div>
                          </div>
                          {% endfor %}
                        {# Not used now - Todo: Delete after we're sure this is right.
                          <div class="ui-tabs" id="stats_tabs1">
                            <ul>
                              <li><a href="#statstabs-1" class="stats_tab">Basic Table</a></li>

                              <li><a href="#statstabs-5" class="stats_tab">Probability Plot</a></li>

                              <li><a href="#statstabs-3" class="stats_tab">Bar Graph (by name)</a></li>

                              <li><a href="#statstabs-4" class="stats_tab">Bar Graph (by rank)</a></li>

                              <li><a href="#statstabs-2" class="stats_tab">Box Plot</a></li>
                            </ul>

                            <div id="statstabs-1">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td>
                                    <table cellpadding="20" cellspacing="0">
                                      <tr>
                                        <td class="fs14 fwb ffl b1 cw cbrb" align="left" width="180">Statistic</td>

                                        <td class="fs14 fwb ffl b1 cw cbrb" align="right" width="60">Value</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" align="left">N of Samples</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">71</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Mean</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">6.109</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Median</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">6.084</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Standard Error (SE)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">0.022</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Standard Deviation (SD)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">0.187</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Minimum</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">5.782</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Maximum</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">6.579</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Range (log2)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">0.797</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left"><span>Range (fold)</span></td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">1.74</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left"><span><a href="/glossary.html#Interquartile" target="_blank" class=
                                        "non_bold">Interquartile Range</a></span></td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">1.13</td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-5">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/nP_eSYO7ZQg.gif" alt="nP_eSYO7ZQg.gif" border="0"></td>
                                </tr>

                                <tr>
                                  <td><br>
                                  <br>
                                  This plot evaluates whether data are normally distributed. Different symbols represent different groups.<br>
                                  <br>
                                  More about <a href="http://en.wikipedia.org/wiki/Normal_probability_plot" target="_blank">Normal Probability Plots</a> and more
                                  about interpreting these plots from the <a href="/glossary.html#normal_probability" target="_blank">glossary</a></td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-2">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td align="left">
                                    <img src="/image/Box_PWNWQMfj.gif" alt="Box_PWNWQMfj.gif" border="0">

                                    <p><span>More about <a href="http://davidmlane.com/hyperstat/A37797.html" target="_blank" class="fs13">Box Plots</a></span></p>
                                  </td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-3">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/Bar_VuPqYbR6.gif" alt="Bar_VuPqYbR6.gif" border="0"></td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-4">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/Bar_9PbdvXZ9.gif" alt="Bar_9PbdvXZ9.gif" border="0"></td>
                                </tr>
                              </table>
                            </div>
                          </div>

                          <div class="ui-tabs" id="stats_tabs2">


                            <ul>
                              <li><a href="#statstabs-1" class="stats_tab">Basic Table</a></li>

                              <li><a href="#statstabs-5" class="stats_tab">Probability Plot</a></li>

                              <li><a href="#statstabs-3" class="stats_tab">Bar Graph (by name)</a></li>

                              <li><a href="#statstabs-4" class="stats_tab">Bar Graph (by rank)</a></li>

                              <li><a href="#statstabs-2" class="stats_tab">Box Plot</a></li>
                            </ul>

                            <div id="statstabs-1">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td>
                                    <table cellpadding="20" cellspacing="0">
                                      <tr>
                                        <td class="fs14 fwb ffl b1 cw cbrb" align="left" width="180">Statistic</td>

                                        <td class="fs14 fwb ffl b1 cw cbrb" align="right" width="60">Value</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" align="left">N of Samples</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">32</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Mean</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">6.176</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Median</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">6.170</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Standard Error (SE)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">0.027</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Standard Deviation (SD)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">0.150</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Minimum</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">5.906</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Maximum</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">6.485</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left">Range (log2)</td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">0.579</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left"><span>Range (fold)</span></td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">1.49</td>
                                      </tr>

                                      <tr align="right">
                                        <td class="fs13 b1 cbw c222" nowrap="yes" align="left"><span><a href="/glossary.html#Interquartile" target="_blank" class=
                                        "non_bold">Interquartile Range</a></span></td>

                                        <td class="fs13 b1 cbw c222" nowrap="yes">1.15</td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-5">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/nP_swDAFlJy.gif" alt="nP_swDAFlJy.gif" border="0"></td>
                                </tr>

                                <tr>
                                  <td><br>
                                  <br>
                                  This plot evaluates whether data are normally distributed. Different symbols represent different groups.<br>
                                  <br>
                                  More about <a href="http://en.wikipedia.org/wiki/Normal_probability_plot" target="_blank">Normal Probability Plots</a> and more
                                  about interpreting these plots from the <a href="/glossary.html#normal_probability" target="_blank">glossary</a></td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-2">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td align="left">
                                    <img src="/image/Box_6sQJ8xhK.gif" alt="Box_6sQJ8xhK.gif" border="0">

                                    <p><span>More about <a href="http://davidmlane.com/hyperstat/A37797.html" target="_blank" class="fs13">Box Plots</a></span></p>
                                  </td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-3">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/Bar_QMWE2VEp.gif" alt="Bar_QMWE2VEp.gif" border="0"></td>
                                </tr>
                              </table>
                            </div>

                            <div id="statstabs-4">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td><img src="/image/Bar_X07QmgsX.gif" alt="Bar_X07QmgsX.gif" border="0"></td>
                                </tr>
                              </table>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </table>
                    #}

                    <p class="sectionheader" id="title3" style="border-radius: 5px;">&nbsp;&nbsp;Calculate Correlations</p>

                    <p id="sectionbody3"></p>

                    <table class="target4" cellpadding="0" cellspacing="0" width="100%">
                      <tr>
                        <td>
                          <div class="ui-tabs" id="corr_tabs">
                            <div id="corrtabs-1">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td>
                                    <input type="hidden" name="orderBy" value="2">

                                    <table cellpadding="2" cellspacing="0" width="619px">
                                      <tr>
                                        <td><span class="ff1 fwb fs12">Method:</span></td>
                                        <td colspan="3">
                                        <select name="corr_method" size="1">
                                            <option value="sample">Sample r</option>
                                            <option value="lit">Literature r</option>
                                            <option value="tissue">Tissue r</option>
                                        </select>
                                        </td>
                                      </tr>
                                      <tr>
                                        <td><span class="ffl fwb fs12">Database:</span></td>
                                        <td colspan="3">
                                        <select name="corr_dataset" size="1">
                                        {% for tissue in corr_tools.dataset_menu %}
                                            {% if tissue.tissue %}
                                                <optgroup label="{{ tissue.tissue }} ------">
                                            {% endif %}
                                            {% for dataset in tissue.datasets %}
                                                <option value="{{ dataset[1] }}"
                                                {% if corr_tools.dataset_menu_selected == dataset[1] %}
                                                    selected
                                                {% endif %}>
                                                    {{ dataset[0] }}
                                                </option>
                                            {% endfor %}
                                            {% if tissue.tissue %}
                                                </optgroup>
                                            {% endif %}
                                        {% endfor %}
                                        </select>
                                        </td>
                                      </tr>


                                      <tr>
                                        <td><span class="ffl fwb fs12">Return:</span></td>

                                        <td><select name="corr_return_results" size="1">
                                        {% for return_result in corr_tools.return_results_menu %}
                                            <option value="{{ return_result }}"
                                            {% if corr_tools.return_results_menu_selected == return_result %}
                                                selected
                                            {% endif %}>
                                            Top {{ return_result }}
                                            </option>
                                        {% endfor %}
                                        </select></td>
                                      </tr>


                                      <tr class="mdp1">
                                        <td><span class="ffl fwb fs12">Samples:</span></td>
                                        <td>
                                            <select name="corr_samples_group" size="1">
                                            {% for group, pretty_group in sample_group_types.items() %}
                                                <option value="{{ group }}">
                                                    {{ pretty_group }}
                                                </option>
                                            {% endfor %}
                                            </select>
                                        </td>
                                      </tr>

                                    </table>
                                    <br>
                                    <div id="corr_sample_method_options">
                                        Pearson <input type="radio" name="corr_sample_method" value="pearson" checked>
                                        &nbsp;&nbsp;&nbsp;
                                        Spearman Rank <input type="radio" name="corr_sample_method" value="spearman">
                                    </div>
                                    <br>

                                    <input type="submit" name="corr_compute" id="corr_compute" class="btn" value="Compute"><br><br>

                                    <span id="sample_r_desc" class="correlation_desc fs12">
                                        The <a href="/correlationAnnotation.html#sample_r" target="_blank">Sample Correlation</a>
                                        is computed
                                        between trait data and any<br>
                                        other traits in the sample database selected above. Use
                                        <a href="/glossary.html#Correlations" target="_blank">Spearman
                                        Rank</a><br>
                                        when the sample size is small (&lt;20) or when there are influential outliers.
                                    </span>
                                    <SPAN id="lit_r_desc" style="display: none;" class="correlation_desc fs12">
                                        The <A HREF="/correlationAnnotation.html" TARGET="_blank">Literature Correlation</A>
                                        (Lit r) between
                                        this gene and all other genes is computed<BR>
                                        using the <A HREF="https://grits.eecs.utk.edu/sgo/sgo.html" TARGET="_blank">
                                        Semantic Gene Organizer</A>
                                        and human, rat, and mouse data from PubMed. <BR>
                                        Values are ranked by Lit r, but Sample r and Tissue r are also displayed.<BR><BR>
                                        <A HREF="/glossary.html#Literature" TARGET="_blank">More on using Lit r</A>
                                    </SPAN>
                                    <SPAN id="tissue_r_desc" style="display: none;" class="correlation_desc fs12">
                                        The <A HREF="/webqtl/main.py?FormID=tissueCorrelation" TARGET="_blank">Tissue Correlation</A>
                                        (Tissue r)
                                        estimates the similarity of expression of two genes<BR>
                                        or transcripts across different cells, tissues, or organs
                                        (<A HREF="/correlationAnnotation.html#tissue_r" TARGET="_blank">glossary</A>).
                                        Tissue correlations<BR>
                                        are generated by analyzing expression in multiple samples usually taken from single cases.<BR>
                                        <STRONG>Pearson</STRONG> and <STRONG>Spearman Rank</STRONG> correlations have been
                                        computed for all pairs of genes<BR> using data from mouse samples.<BR>
                                    </SPAN>

                                    <br>
                                  </td>
                                </tr>
                              </table>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </table>

                    <p class="sectionheader" id="title4" style="border-radius: 5px;">&nbsp;&nbsp;Mapping Tools</p>

                    <p id="sectionbody4"></p>

                    <table class="target2" cellpadding="0" cellspacing="0" width="100%">
                      <tr>
                        <td>
                          <div class="ui-tabs" id="mapping_tabs">
                            <ul>
                              <li><a href="#mappingtabs-1">Interval</a></li>

                              <li><a href="#mappingtabs-2">Marker Regression</a></li>

                              <li><a href="#mappingtabs-3">Composite</a></li>

                              <li><a href="#mappingtabs-4">Pair-Scan</a></li>
                            </ul>

                            <div id="mappingtabs-1">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td class="fs12 fwn" nowrap="on" valign="top">
                                    <table cellpadding="2" cellspacing="0" width="263px">
                                      <tr>
                                        <td><span class="ffl fwb fs12">Chromosome:</span></td>

                                        <td colspan="3"><select name="chromosomes1" size="1">
                                          <option value="-1">
                                            All
                                          </option>

                                          <option value="0">
                                            1
                                          </option>

                                          <option value="1">
                                            2
                                          </option>

                                          <option value="2">
                                            3
                                          </option>

                                          <option value="3">
                                            4
                                          </option>

                                          <option value="4">
                                            5
                                          </option>

                                          <option value="5">
                                            6
                                          </option>

                                          <option value="6">
                                            7
                                          </option>

                                          <option value="7">
                                            8
                                          </option>

                                          <option value="8">
                                            9
                                          </option>

                                          <option value="9">
                                            10
                                          </option>

                                          <option value="10">
                                            11
                                          </option>

                                          <option value="11">
                                            12
                                          </option>

                                          <option value="12">
                                            13
                                          </option>

                                          <option value="13">
                                            14
                                          </option>

                                          <option value="14">
                                            15
                                          </option>

                                          <option value="15">
                                            16
                                          </option>

                                          <option value="16">
                                            17
                                          </option>

                                          <option value="17">
                                            18
                                          </option>

                                          <option value="18">
                                            19
                                          </option>

                                          <option value="19">
                                            X
                                          </option>
                                        </select></td>
                                      </tr>

                                      <tr>
                                        <td><span class="ffl fwb fs12">Mapping Scale:</span></td>

                                        <td><select name="scale1" size="1" onchange=
                                        "checkUncheck(window.document.dataInput.scale1.value, window.document.dataInput.permCheck1, window.document.dataInput.bootCheck1)">
                                        <option value="physic">
                                            Megabase
                                          </option>

                                          <option value="morgan">
                                            Centimorgan
                                          </option>
                                        </select></td>
                                      </tr>
                                    </table><br>
                                    <input type="checkbox" name="permCheck1" class="checkbox" checked>Permutation Test (n=2000)<br>
                                    <input type="checkbox" name="bootCheck1" class="checkbox">Bootstrap Test (n=2000)<br>
                                    <input type="checkbox" name="parentsf14regression1" class="checkbox">Use Parents<br>
                                    <input type="checkbox" name="applyVarianceSE1" class="checkbox">Use Weighted<br>
                                    <br>
                                    <input type="button" name="interval" class="btn" value=" Compute "><br>
                                    <br>
                                  </td>
                                </tr>

                                <tr>
                                  <td valign="top"><span class="fs12"><a href="/glossary.html#intmap" target="_blank">Interval Mapping</a> computes linkage maps
                                  for the entire genome or single<br>
                                  chromosomes. The <a href="/glossary.html#permutation" target="_blank">Permutation Test</a> estimates suggestive and
                                  significant<br>
                                  linkage scores. The <a href="/glossary.html#bootstrap" target="_blank">Bootstrap Test</a> estimates the precision of the QTL
                                  location.</span><br></td>
                                </tr>
                              </table>
                            </div>

                            <div id="mappingtabs-2">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td class="fs12 fwn" nowrap="on" valign="top">
                                    <table cellpadding="2" cellspacing="0" width="263px">
                                      <tr>
                                        <td><span class="ffl fwb fs12"><strong>Display LRS greater than:</strong></span></td>

                                        <td><input type="text" name="suggestive" size="5" maxlength="8"></td>
                                      </tr>

                                      <tr>
                                        <td><input type="checkbox" name="displayAllLRS" class="checkbox"> <span class="ffl fs12">Display all LRS</span></td>
                                      </tr>

                                      <tr>
                                        <td><input type="checkbox" name="parentsf14regression2" class="checkbox"> <span class="ffl fs12">Use Parents</span></td>
                                      </tr>

                                      <tr>
                                        <td><input type="checkbox" name="applyVarianceSE2" class="checkbox"> <span class="ffl fs12">Use Weighted</span></td>
                                      </tr>
                                    </table><br>
                                    <input type="button" name="marker" class="btn" value=" Compute "><br>
                                    <br>
                                  </td>
                                </tr>

                                <tr>
                                  <td valign="top"><span class="fs12"><a href="/glossary.html#" target="_blank">Marker regression</a> computes and displays LRS
                                  values for individual markers.<br>
                                  This function also lists additive effects (phenotype units per allele) and<br>
                                  dominance deviations for some datasets.<br></span><br></td>
                                </tr>
                              </table>
                            </div>

                            <div id="mappingtabs-3">
                              <table cellpadding="3" cellspacing="0" width="100%">
                                <tr>
                                  <td class="fs12 fwn" nowrap="on" valign="top">
                                    <table cellpadding="2" cellspacing="0" width="325px">
                                      <tr>
                                        <td><span class="ffl fwb fs12">Chromosome:</span></td>

                                        <td colspan="3"><select name="chromosomes2" size="1">
                                          <option value="-1">
                                            All
                                          </option>

                                          <option value="0">
                                            1
                                          </option>

                                          <option value="1">
                                            2
                                          </option>

                                          <option value="2">
                                            3
                                          </option>

                                          <option value="3">
                                            4
                                          </option>

                                          <option value="4">
                                            5
                                          </option>

                                          <option value="5">
                                            6
                                          </option>

                                          <option value="6">
                                            7
                                          </option>

                                          <option value="7">
                                            8
                                          </option>

                                          <option value="8">
                                            9
                                          </option>

                                          <option value="9">
                                            10
                                          </option>

                                          <option value="10">
                                            11
                                          </option>

                                          <option value="11">
                                            12
                                          </option>

                                          <option value="12">
                                            13
                                          </option>

                                          <option value="13">
                                            14
                                          </option>

                                          <option value="14">
                                            15
                                          </option>

                                          <option value="15">
                                            16
                                          </option>

                                          <option value="16">
                                            17
                                          </option>

                                          <option value="17">
                                            18
                                          </option>

                                          <option value="18">
                                            19
                                          </option>

                                          <option value="19">
                                            X
                                          </option>
                                        </select></td>
                                      </tr>

                                      <tr>
                                        <td><span class="ffl fwb fs12">Mapping Scale:</span></td>

                                        <td><select name="scale2" size="1" onchange=
                                        "checkUncheck(window.document.dataInput.scale2.value, window.document.dataInput.permCheck2, window.document.dataInput.bootCheck2)">
                                        <option value="physic">
                                            Megabase
                                          </option>

                                          <option value="morgan">
                                            Centimorgan
                                          </option>
                                        </select></td>
                                      </tr>

                                      <tr>
                                        <td><span class="ffl fwb fs12">Control Locus:</span></td>

                                        <td><input type="text" name="controlLocus" class="controlLocus"></td>
                                      </tr>
                                    </table><br>
                                    <input type="checkbox" name="permCheck2" class="checkbox" checked>Permutation Test (n=2000)<br>
                                    <input type="checkbox" name="bootCheck2" class="checkbox">Bootstrap Test (n=2000)<br>
                                    <input type="checkbox" name="parentsf14regression3" class="checkbox">Use Parents<br>
                                    <br>
                                    <input type="button" name="composite" class="btn" value=" Compute "><br>
                                    <br>
                                  </td>
                                </tr>

                                <tr>
                                  <td valign="top"><span><a href="/glossary.html#Composite" target="_blank">Composite Interval Mapping</a> allows you to control
                                  for a single marker as<br>
                                  a cofactor. To find a control marker, run the <strong>Marker Regression</strong> function.</span><br></td>
                                </tr>
                              </table>
                            </div>

                            <div id="mappingtabs-4">
                              <table cellpadding="0" cellspacing="0" width="100%">
                                <tr>
                                  <td class="fs12 fwn" nowrap="on">
                                    <table cellpadding="2" cellspacing="0" width="232px">
                                      <tr>
                                        <td><span class="ffl fwb fs12"><strong>Sort by:</strong></span></td>

                                        <td><select name="graphSort" size="1">
                                          <option value="0">
                                            LRS Full
                                          </option>

                                          <option value="1">
                                            LRS Interact
                                          </option>
                                        </select></td>
                                      </tr>

                                      <tr>
                                        <td><span class="ffl fwb fs12"><strong>Return:</strong></span></td>

                                        <td><select name="pairScanReturn" size="1">
                                          <option value="50">
                                            top 50
                                          </option>

                                          <option value="100">
                                            top 100
                                          </option>

                                          <option value="200">
                                            top 200
                                          </option>

                                          <option value="500">
                                            top 500
                                          </option>
                                        </select></td>
                                      </tr>
                                    </table><br>
                                    <input type="checkbox" name="directPermuCheckbox" class="checkbox" checked><span class="ffl fs12">Permutation Test
                                    (n=500)</span><br>
                                    <br>
                                    <input type="button" class="btn" value=" Compute " onclick="dataEditingFunc(this.form,'directPlot');"><br>
                                    <br>
                                  </td>
                                </tr>

                                <tr>
                                  <td valign="top"><span><a href="/glossary.html#Pair_Scan" target="_blank">Pair-Scan</a> searches for pairs of chromosomal regions
                                  that are<br>
                                  involved in two-locus epistatic interactions.</span><br></td>
                                </tr>
                              </table>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </table>

                    <p class="sectionheader" id="title5" style="border-radius: 5px;">&nbsp;&nbsp;Review and Edit Data</p>

                    <table id="stats_table" class="table table-striped table-bordered" />

                    <p id="sectionbody5"></p>

                    <table class="target5" id="value_table" cellpadding="0" cellspacing="0" width="100%">
                      <tr>
                        <td>
                          <div>
                            <div class="well">
                            <fieldset id="showHideOptions">
                                <legend>Block samples</legend>
                                <p>Edit or delete values in the Trait Data boxes, and use the
                                    <strong>Reset</strong> option as
                                    needed.
                                </p>


                                <div id="blockMenuSpan" class="input-append">
                                    <label for="remove_samples_field">Block samples by index:</label>


                                    <input type="text" id="remove_samples_field">
                                    <select id="block_group" size="1">
                                      <option value="primary">
                                        {{ sample_group_types['primary_only'] }}
                                      </option>
                                      <option value="other">
                                        {{ sample_group_types['other_only'] }}
                                      </option>
                                    </select>
                                    <input type="button" id="block_by_index" class="btn" value="Block">
                                </div>
                                <div id="remove_samples_invalid" class="alert alert-error" style="display:none;">
                                      Please check that your input is formatted correctly, e.g. <strong>3, 5-10, 12</strong>
                                </div>

                                <br>

                                {% if sample_groups[0].attributes %}
                                <div class="input-append">
                                    <label for="exclude_menu">Block samples by group:</label>
                                    <select id="exclude_menu" size=1>
                                      {% for attribute in sample_groups[0].attributes %}
                                      <option value="{{ sample_groups[0].attributes[attribute].name.replace(' ', '_') }}">
                                          {{ sample_groups[0].attributes[attribute].name }}</option>
                                      {% endfor %}
                                    </select>
                                    <select id="attribute_values" size=1>
                                    </select>
                                    <input type="button" id="exclude_group" class="btn" value="Block">
                                </div>
                                {% endif %}
                                <br>
                                <div>
                                  <input type="button" id="hide_no_value" class="btn" value="Hide No Value">
                                  <input type="button" id="block_outliers" class="btn" value="Block Outliers">
                                  <input type="button" id="reset" class="btn btn-inverse" value="Reset">
                                  <span class="input-append">
                                    <input type="button" id="export" class="btn" value="Export">
                                    <select id="export_format" class="select optional span2">
                                      <option value="excel">Excel</option>
                                      <option value="csv">CSV</option>
                                    </select>
                                  </span>
                                </div>
                            </fieldset>
                            <br>
                            <div>
                                <p>Outliers highlighted in
                                        <strong style="background-color:yellow;">yellow</strong>
                                        can be hidden using
                                        the <strong>Hide Outliers</strong> button.
                                </p>

                                <p>Samples with no value (x) can be hidden by clicking
                                        <strong>Hide No Value</strong> button.
                                </p>
                            </div>
                            </div>
                            <br>



                            <div style="width:80%;margin:0;padding:0;border:none;">
                            {% for sample_type in sample_groups %}
                            <div style="float:left;width:50%;">
                            <h2>{{ sample_type.header }}</h2>

                            <div id="{{ sample_type.sample_group_type }}">
                              <table class="table table-hover not_tablesorter"  {# Todo: Turn tablesorter back on #}
                                     id="{{ 'sortable%i' % (loop.index) }}"
                                     cellpadding="0" cellspacing="0">
                                <tr>
                                  <th class="fs13 fwb ff1 b1 cw cbrb" align="right" width="60">Index</th>

                                  <th class="fs13 fwb ff1 b1 cw cbrb" align="right" width="100">Sample</th>

                                  <th class="fs13 fwb ff1 b1 cw cbrb" align="right" width="70">Value</th>
                                  {% if sample_type.se_exists() %}
                                  <th class="fs13 fwb ff1 b1 cw cbrb" width="20">&nbsp;</th>

                                  <th class="fs13 fwb ff1 b1 cw cbrb" align="right" width="80">SE</th>
                                  {% endif %}

                                  {% for attribute in sample_type.attributes|sort() %}
                                    <th class="fs13 fwb ff1 b1 cw cbrb" align="right" width="60">
                                        {{ sample_type.attributes[attribute].name }}
                                    </th>
                                  {% endfor %}
                                </tr>

                                {% for sample in sample_type.sample_list %}
                                <tr class="{{ sample.class_outlier }} value_se" id="{{ sample.this_id }}">
                                  <td class="std_cell column_name-Index" align="right" width="45">
                                    {{ loop.index }}
                                    <input type="checkbox" name="selectCheck"
                                           class="checkbox edit_sample_checkbox"
                                           value="{{ sample.name }}" checked="checked">
                                  </td>

                                  <td class="std_cell column_name-Sample" align="right" width="100">
                                    <span class="fs14 fwn ffl edit_sample_sample_name">
                                        {{ sample.name }}
                                    </span>
                                  </td>

                                  {# Todo: Add IDs #}
                                  <td class="std_cell column_name-Value" align="right" width="70">
                                    <input type="text" data-value="{{ sample.display_value }}" name="{{ sample.name }}"
                                           class="trait_value_input edit_sample_value"
                                           value="{{ sample.display_value }}" size="8" maxlength="8"
                                           style="text-align:right; background-color:#FFFFFF;">
                                  </td>

                                  {% if sample_type.se_exists() %}
                                  <td class="std_cell" align="center" width="20">
                                    
                                  </td>

                                  {# Todo: Add IDs #}
                                  <td class="std_cell column_name-SE" align="right" width="80">
                                    <input type="text" data-value="{{ sample.display_variance }}" name=""{{ 'V' + sample.name}}"
                                           class="trait_value_input edit_sample_se"
                                           value="{{ sample.display_variance }}"
                                           size="8" maxlength="8" style="text-align:right">
                                  </td>
                                  {% endif %}

                                  {# Loop through each attribute type and input value #}
                                  {% for attribute in sample_type.attributes|sort() %}
                                  <td class="std_cell column_name-{{ sample_type.attributes[attribute].name.replace(' ', '_') }}"
                                      align="right" width="80">
                                    {{ sample.extra_attributes[sample_type.attributes[attribute].name] }}
                                  </td>
                                  {% endfor %}
                                </tr>
                                {% endfor %}

                              </table>
                            </div>
                            </div>
                            {% endfor %}
                            </div>
                          </div>
                        </td>
                      </tr>
                    </table>
                    <input type="hidden" name="Default_Name">
                  </form>
                </td>
              </tr>
            </table>
          </td>
        </tr>
    </div>

    <!-- End of body -->

{% endblock %}

{% block js %}
    <script>
        js_data = {{ js_data | safe }}
    </script>

    <script type="text/javascript" src="/static/new/js_external/underscore-min.js"></script>-->
    <script type="text/javascript" src="/static/new/js_external/underscore.string.min.js"></script>
    <script type="text/javascript" src="/static/new/packages/ValidationPlugin/dist/jquery.validate.min.js"></script>

    <script type="text/javascript" src="/static/new/javascript/stats.js"></script>
    <script type="text/javascript" src="/static/new/javascript/show_trait.js"></script>
    <script type="text/javascript" src="/static/new/javascript/validation.js"></script>
{% endblock %}
